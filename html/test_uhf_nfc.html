<!DOCTYPE HTML>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, initial-scale=1.0, width=device-width" />
    <meta name="format-detection" content="telephone=no, email=no, date=no, address=no">
    <title>test_uhf_nfc</title>
    <link rel="stylesheet" type="text/css" href="../css/api.css" />
    <link rel="stylesheet" type="text/css" href="../css/aui.css" />
    <style>
        p {
            margin-bottom: 0.5rem;
        }
    </style>
</head>

<body>
    <div id='title'>1.testUHF_I6310</div>
    <div class="aui-content-padded" >
        <div class="aui-form">
            <div class="aui-input-row ">
                <i class="aui-input-addon  aui-iconfont aui-icon-people"></i>
                <input type="text" class="aui-input" placeholder="展示读取到的信息" id="read-info_I6310"/>
            </div>
            <div class="aui-btn-row">
                <p><div class="aui-btn aui-btn-success aui-btn-block" onclick="testReadUHF_I6310()">
                    读取UHF_I6310
                </div></p>
            </div>
        </div>
        <div class="aui-form">
            <div class="aui-input-row ">
                <i class="aui-input-addon  aui-iconfont aui-icon-people"></i>
                <input type="text" class="aui-input" placeholder="要写入的信息" id="write-info_I6310"/>
            </div>
            <div class="aui-btn-row">
                <p><div class="aui-btn aui-btn-success aui-btn-block" onclick="testWriteUHF_I6310()">
                    写入UHF_I6310
                </div></p>
            </div>
        </div>
        <div class="aui-btn-row">
            <p><div class="aui-btn aui-btn-success aui-btn-block" onclick="testActivity_I6310()">
                打开测试页面UHF_I6310
            </div></p>
        </div>
    </div>

    <div id='title'>2.testUHF</div>
    <div class="aui-content-padded" >
        <div class="aui-form">
            <div class="aui-input-row ">
                <i class="aui-input-addon  aui-iconfont aui-icon-people"></i>
                <input type="text" class="aui-input" placeholder="展示读取到的信息" id="read-info"/>
            </div>
            <div class="aui-btn-row">
                <p><div class="aui-btn aui-btn-success aui-btn-block" onclick="testReadUHF()">
                    读取UHF
                </div></p>
            </div>
        </div>
        <div class="aui-form">
            <div class="aui-input-row ">
                <i class="aui-input-addon  aui-iconfont aui-icon-people"></i>
                <input type="text" class="aui-input" placeholder="要写入的信息" id="write-info"/>
            </div>
            <div class="aui-btn-row">
                <p><div class="aui-btn aui-btn-success aui-btn-block" onclick="testWriteUHF()">
                    写入UHF
                </div></p>
            </div>
        </div>
    </div>

    <div id='title'>3.testNFC</div>
    <div class="aui-content-padded" >
        <div class="aui-form">
            <div class="aui-input-row ">
                <i class="aui-input-addon aui-iconfont aui-icon-people"></i>
                <input type="text" class="aui-input" placeholder="展示读取到的信息" id="nfcread-info"/>
            </div>
            <div class="aui-btn-row">
                <p><div class="aui-btn aui-btn-success aui-btn-block" onclick="testReadNFC()">
                    读取NFC
                </div></p>
            </div>
        </div>
    </div>

    <div id='title'>4.testNFC_2023-ISO14443A</div>
    <div class="aui-content-padded" >
        <div class="aui-form">
            <div class="aui-input-row ">
                <i class="aui-input-addon aui-iconfont aui-icon-people"></i>
                <input type="text" class="aui-input" placeholder="作读写的内容" id="nfc_2023_text"/>
            </div>
            <div class="aui-btn-row">
                <p><div class="aui-btn aui-btn-success aui-btn-block" onclick="readNFC_2023()">
                    读取NFC-2023
                </div></p>
                <p><div class="aui-btn aui-btn-success aui-btn-block" onclick="writeNFC_2023()">
                    写入NFC-2023
                </div></p>
            </div>
        </div>
    </div>

    <div id='title'>5.testNFC_2023-ZBL-ISO15693</div>
    <div class="aui-content-padded" >
        <div class="aui-form">
            <div class="aui-input-row ">
                <i class="aui-input-addon aui-iconfont aui-icon-people"></i>
                <div><input type="text" class="aui-input" id="nfc_str_zbl" value="0" placeholder="设置读块的起始位"/><div>
                <div><input type="text" class="aui-input" id="nfc_uid_zbl" placeholder="展示读取NFC芯片的UID" /><div>
                <div><input type="text" class="aui-input" id="nfc_result_zbl" placeholder="对NFC芯片进行读写的内容"/><div>
                <form> 值类型：
                    <input type="radio" name="radioNFCZbl" value="0" checked> 16进制
                    <input type="radio" name="radioNFCZbl" value="1"> UTF8
                </form>
            </div>
            <div class="aui-btn-row">
                <p><div class="aui-btn aui-btn-success aui-btn-block" onclick="readNFCZbl()">
                    测试高频NFC读单块
                </div></p>
                <p><div class="aui-btn aui-btn-success aui-btn-block" onclick="readNFCBlocksZbl()">
                    测试高频NFC读多块
                </div></p>
                <p><div class="aui-btn aui-btn-success aui-btn-block" onclick="writeNFCZbl()">
                    测试高频NFC写单块
                </div></p>
                <p><div class="aui-btn aui-btn-success aui-btn-block" onclick="writeNFCBlocksZbl()">
                    测试高频NFC写多块
                </div></p>
            </div>
        </div>
    </div>

    <div id='title'>6.testNFC_2025重汽项目-带串口-ISO14443A</div>
    <div class="aui-content-padded" >
        <div class="aui-form">
            <div class="aui-input-row ">
                <i class="aui-input-addon aui-iconfont aui-icon-people"></i>
                <div><input type="text" class="aui-input" id="nfc_2025_text" placeholder="对NFC芯片进行读写的内容"/><div>
                <form> 值类型：
                    <input type="radio" name="radioNFCZhxx" value="0" checked> 16进制
                    <input type="radio" name="radioNFCZhxx" value="1"> UTF8
                </form>
            </div>
            <div class="aui-btn-row">
                <p><div class="aui-btn aui-btn-success aui-btn-block" onclick="readUHF_ZHXX_2025()" >yb-测试高频NFC2025-读字符串</div></p>
                <p><div class="aui-btn aui-btn-success aui-btn-block" onclick="writeUHF_ZHXX_2025()" >yb-测试高频NFC2025-写字符串</div></p>
                <p><div class="aui-btn aui-btn-success aui-btn-block" onclick="readEPC_ZHXX_2025()" >yb-测试高频NFC2025-获取EPC标签号</div></p>
            </div>
        </div>
    </div>
</body>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript" src="../script/jquery-1.8.2.min.js"></script>
<script type="text/javascript" src="../script/doT.min.js"></script>
<script type="text/javascript" src="../script/public.js"></script>
<script type="text/javascript">

    var moduleUHF = null;
    var moduleNFC = null;
    var audioModule = null;
    var moduleUHF_I6310 = null;
    var moduleNFC_2023 = null;
    var moduleNFC_ZBL = null;
    var moduleUHF_ZHXX_2025 = null;
    apiready = function(){
        moduleUHF = api.require('moduleUHF');
        moduleNFC = api.require('moduleNFC');
        audioModule = api.require("OtherOffLineSpeakModule");
        moduleUHF_I6310 = api.require('moduleUHF_I6310');
        moduleNFC_2023 = api.require('moduleNFC_2023');
        moduleNFC_ZBL = api.require('moduleNFC_ZBL');
        moduleUHF_ZHXX_2025 = api.require('moduleUHF_ZHXX_2025');
    }

    // UHF_I6310
    function testReadUHF_I6310(){
        console.log("-------here 1");
        var params = {name : 'yb'};
        moduleUHF_I6310.readUHF(params, function(ret, err){
            console.log("-------here 2");
            if (ret) {
                var data = ret.data;
                $("#read-info_I6310").val(JSON.stringify(data));
                // alert(JSON.stringify(data));
            } else {
                alert(JSON.stringify(err));
            }
        });
    }

    function testWriteUHF_I6310(){
        console.log("-------here 3");
        var params = {
            str : $("#write-info_I6310").val()
        };
        moduleUHF_I6310.writeUHF(params, function(ret, err){
            console.log("-------here 4");
            if (ret) {
                console.log(JSON.stringify(ret.data));
                // alert(JSON.stringify(data));
            } else {
                alert(JSON.stringify(err));
            }
        });
    }

    function testActivity_I6310(){
        var params = {
        };
        moduleUHF_I6310.startActivity(params);
    }

    // UHF
    function testReadUHF(){
        console.log("-------here 1");
        var params = {name : 'yb'};
		moduleUHF.readUHF(params, function(ret, err){
            console.log("-------here 2");
            if (ret) {
                var data = ret.data;
                $("#read-info").val(JSON.stringify(data));
                // alert(JSON.stringify(data));
            } else {
                alert(JSON.stringify(err));
            }
        });
    }

    function testWriteUHF(){
        console.log("-------here 3");
        var params = {
            str : $("#write-info").val()
        };
        moduleUHF.writeUHF(params, function(ret, err){
            console.log("-------here 4");
            if (ret) {
                console.log(JSON.stringify(ret.data));
                // alert(JSON.stringify(data));
            } else {
                alert(JSON.stringify(err));
            }
        });
    }

    function testReadNFC(){
        console.log("-------here 1");
        var params = {name : 'yb'};
		moduleNFC.readNFC(params, function(ret, err){
            console.log("-------here 2");
            if (ret) {
                var data = ret.data;
                $("#nfcread-info").val(JSON.stringify(data));
                // alert(JSON.stringify(data));
            } else {
                alert(JSON.stringify(err));
            }
        });
    }

    // moduleNFC_2023模块的读操作，直接读标签的文本信息
    function readNFC_2023(){
        let params = {
        };
        moduleNFC_2023.readNFC(params, function(ret, err){
            if (ret) {
                $("#nfc_2023_text").val(ret.data);
                api.toast({
                    msg: ret.info,
                    duration: 3000,
                    location: 'middle'
                });
            } else {
                api.toast({
                    msg: "读取失败！" + JSON.stringify(err),
                    duration: 3000,
                    location: 'middle'
                });
            }
        });
    }
    // moduleNFC_2023模块的写操作，直接写标签的文本信息
    function writeNFC_2023(){
        let text = $("#nfc_2023_text").val();
        var params = {
            text : text,
        };
        moduleNFC_2023.writeNFC(params, function(ret, err){
            if (ret) {
                var data = ret.data;
                api.toast({
                    msg: "写入完成！",
                    duration: 3000,
                    location: 'middle'
                });
            } else {
                api.toast({
                    msg: "写入失败！" + JSON.stringify(err),
                    duration: 3000,
                    location: 'middle'
                });
            }
        });
    }


    // 2023-朱博龙的NFC标签（ISO15693）-读写功能
    // 读单块，传参读块起始位、显示值的格式。支持16进制和UTF8
    function readNFCZbl() {
        var blockIndex = $("#nfc_str_zbl").val();

        // 获取值类型的radio设置的值
        var dataType = $('input[name="radioNFCZbl"]:checked').val();

        var params = {
            blockIndex: blockIndex,
            dataType: dataType,
        };
        moduleNFC_ZBL.readNFC(params, function (ret, err) {
            if (ret) {
                $("#nfc_uid_zbl").val(ret.uid);
                $("#nfc_result_zbl").val(ret.data);
                api.toast({
                    msg: "读取完成！NFC-ZBL-1",
                    duration: 3000,
                    location: 'botton'
                });
                console.log("读取完成！NFC-ZBL-1 " + JSON.stringify(ret));
                <!--                    alert(JSON.stringify(ret));-->
            } else {
                <!--                    alert(JSON.stringify(err));-->
            }
        });
    }
    // 读多块，默认读10块，传参读块起始位。
    function readNFCBlocksZbl(){
        var blockIndex = $("#nfc_str_zbl").val();

        // 获取值类型的radio设置的值
        var dataType = $('input[name="radioNFCZbl"]:checked').val();

        var params = {
            blockIndex : blockIndex,
            blockNum : 3,
            dataType: dataType,
        };
        moduleNFC_ZBL.readNFC(params, function(ret, err){
            if (ret) {
                $("#nfc_uid_zbl").val(ret.uid);
                $("#nfc_result_zbl").val(ret.data);
                api.toast({
                    msg: "读取完成！NFC-ZBL-2",
                    duration: 3000,
                    location: 'botton'
                });
                console.log("读取完成！NFC-ZBL-2 " + JSON.stringify(ret));
                <!--                    alert(JSON.stringify(ret));-->
            } else {
                <!--                    alert(JSON.stringify(err));-->
            }
        });
    }
    // 写入单块-支持16进制和UTF8
    function writeNFCZbl(){
        var blockIndex = $("#nfc_str_zbl").val();

        // 获取值类型的radio设置的值
        var dataType = $('input[name="radioNFCZbl"]:checked').val();

        var params = {
            blockIndex : blockIndex,
            blockNum : 1,
            blockData : $("#nfc_result_zbl").val(),
            dataType: dataType,
        };
        moduleNFC_ZBL.writeNFC(params, function(ret, err){
            if (ret) {
                var data = ret.data;
                api.toast({
                    msg: "写入状态：" + ret.operateStatus + ". NFC-ZBL-3 \n" + ret.operateMsg,
                    duration: 3000,
                    location: 'middle'
                });
                console.log("写入完成！NFC-ZBL-3 " + JSON.stringify(ret));
                <!--                    alert(JSON.stringify(ret));-->
            } else {
                <!--                    alert(JSON.stringify(err));-->
            }
        });
    }
    // 写入多块，默认UTF-8，自行传参决定写入块的数量。
    function writeNFCBlocksZbl(){
        var blockIndex = $("#nfc_str_zbl").val();
        // 获取值类型的radio设置的值
        var dataType = $('input[name="radioNFCZbl"]:checked').val();

        var params = {
            blockIndex : blockIndex,
            blockNum : 3,
            blockData : $("#nfc_result_zbl").val(),
            dataType: dataType, // 默认0为16进制，1为utf8
        };
        moduleNFC_ZBL.writeNFC(params, function(ret, err){
            if (ret) {
                var data = ret.data;
                api.toast({
                    msg: "写入状态：" + ret.operateStatus + ". NFC-ZBL-4 \n" + ret.operateMsg,
                    duration: 3000,
                    location: 'middle'
                });
                console.log("写入完成！NFC-ZBL-4 " + JSON.stringify(ret));
                <!--                    alert(JSON.stringify(ret));-->
            } else {
                <!--                    alert(JSON.stringify(err));-->
            }
        });
    }


    // moduleUHF_ZHXX_2025模块的读操作，直接读标签的文本信息
    function readUHF_ZHXX_2025(){
        console.log("开始读取！");
        // 获取值类型的radio设置的值
        var dataType = $('input[name="radioNFCZhxx"]:checked').val();

        var params = {
            dataType: dataType,
        };
        moduleUHF_ZHXX_2025.readUHF(params, function(ret, err){
            if (ret) {
                console.log("读取完成！" + JSON.stringify(ret));
                if (ret.flag == "yes") {
                    api.toast({
                        msg: "读取成功：" + JSON.stringify(ret),
                        duration: 3000,
                        location: 'middle'
                    });
                } else {
                    api.toast({
                        msg: "读取失败！" + JSON.stringify(ret),
                        duration: 3000,
                        location: 'middle'
                    });
                }
                $("#nfc_2025_text").val(ret.info);
            } else {
                api.toast({
                    msg: "读取失败！" + JSON.stringify(err),
                    duration: 3000,
                    location: 'middle'
                });
            }
        });
    }
    // moduleUHF_ZHXX_2025模块的写操作，直接写标签的文本信息
    function writeUHF_ZHXX_2025(){
        let text = $("#nfc_2025_text").val();
        // 获取值类型的radio设置的值
        var dataType = $('input[name="radioNFCZhxx"]:checked').val();

        var params = {
            str : text,
            dataType: dataType,
        };
        moduleUHF_ZHXX_2025.writeUHF(params, function(ret, err){
            if (ret) {
                console.log("写入完成！" + JSON.stringify(ret));
                if (ret.flag == "yes") {
                    api.toast({
                        msg: "写入成功：" + JSON.stringify(ret),
                        duration: 3000,
                        location: 'middle'
                    });
                } else {
                    api.toast({
                        msg: "读取失败！" + JSON.stringify(ret),
                        duration: 3000,
                        location: 'middle'
                    });
                }
            } else {
                api.toast({
                    msg: "写入失败！" + JSON.stringify(err),
                    duration: 3000,
                    location: 'middle'
                });
            }
        });
    }

    // moduleUHF_ZHXX_2025模块的读取序列号操作
    function readEPC_ZHXX_2025(){
        var params = {
        };
        moduleUHF_ZHXX_2025.readEPC(params, function(ret, err){
            if (ret) {
                console.log("读取完成！" + JSON.stringify(ret));
                if (ret.flag == "yes") {
                    api.toast({
                        msg: "读取序列号成功：" + ret.epc,
                        duration: 3000,
                        location: 'middle'
                    });
                } else {
                    api.toast({
                        msg: "读取失败！" + JSON.stringify(ret),
                        duration: 3000,
                        location: 'middle'
                    });
                }
            } else {
                api.toast({
                    msg: "读取失败！" + JSON.stringify(err),
                    duration: 3000,
                    location: 'middle'
                });
            }
        });
    }
</script>

</html>
